{% extends base_path %}



{% block pagecontent %}
    <h1>Bookings Management</h1>

    <form name="findAccommodation" method="post" 
          action="/bookings/findaccommodation">
      <p><strong>Search</strong></p>
      <table class="listing" cellspacing="0">
        <tr>
          <td>City</td>
          <td> 
              <select name="city">
                  {% for description in cities %}
                      <option{%ifequal city description %} selected="1"{%endifequal%}>
                      {{description}}
                      </option>
                  {% endfor %}
              </select>
          </td>
        </tr>
        <tr>
          <td>Type</td>
          <td> 
              <select name="type">
                  {% for description in accomtypes %}
                      <option{%ifequal type description %} selected="1"{%endifequal%}>
                      {{description}}
                      </option>
                  {% endfor %}
              </select>
          </td>
        </tr>
        <tr>
          <td>Start Date</td>
          <td> <input type="text" name="start" value="{{ start }}" /> </td>
        </tr>
        <tr>
          <td>Number of nights</td>
          <td> <input type="text" name="nights" value="{{ nights }}" /> </td>
        </tr>
        <tr>
          <td>Number of people</td>
          <td> <input type="text" name="people" value="{{ people }}" /> </td>
        </tr>
      </table>
      <input title="Find accommodation"
             type="submit" value="Find Accommodation" />
    </form>

    {% if results %}
    <form name="reserveAccommodation" method="post" 
          action="/bookings/reserveaccommodation">
      <table class="listing" cellspacing="0">
          <thead>
            <td>Select</td>
            <td>Owner</td>
            <td>Venue</td>
            <td>Room</td>
            <td>Bed</td>
            <td>Type</td>
            <td>Capacity</td>
          </thead>
          {% for result in results %}
          <tr>
            <td> <input type="checkbox" name="{{ result.0 }}" /> </td>
            <td>{{ result.1 }} </td>
            <td>{{ result.2 }} </td>
            <td>{{ result.3 }} </td>
            <td>{{ result.4 }} </td>
            <td>{{ result.5 }} </td>
            <td>{{ result.6 }} </td>
          </tr>
          {% endfor %}
      </table>
      <input type="hidden" name="elementkey" value="{{ elementkey }}" />
      <input type="hidden" name="city" value="{{ city }}" /> 
      <input type="hidden" name="type" value="{{ type }}" />
      <input type="hidden" name="start" value="{{ start }}" />
      <input type="hidden" name="nights" value="{{ nights }}" />
      <input type="hidden" name="people" value="{{ people }}" />
      <input title="Reserve accommodation"
             type="submit" value="Reserve Accommodation" />
    </form>
    {% endif %}
    <hr />

    <p><strong>Contracted Bookings</strong>
      <a title="Add a new booking"
         href="/bookings/capturecontractedbooking">
          <img src="/images/add.png"/>
      </a>
    </p>
    <table class="listing" cellspacing="0">
        <thead>
          <td colspan="3">Reference</td>
        </thead>
        {% for contractedbooking in contractedbookings %}
        <tr>
          <td><a href="/bookings/viewcontractedbooking?bookingkey={{ contractedbooking.key }}">{{ contractedbooking.bookingNumber }}</a></td>
          <td class="action">
            <a title="Edit this booking"
              href="/bookings/editcontractedbooking?contractedbookingkey={{ contractedbooking.key }}">
              <img src="/images/edit.png"/>
            </a></td>
          <td class="action">
            <a title="Delete this booking"
              href="/bookings/deletecontractedbooking?contractedbookingkey={{ contractedbooking.key }}"
                   onclick="return confirm('Are you sure?');">
              <img src="/images/delete.png"/>
            </a></td>
        </tr>
        {% endfor %}
    </table>

    <hr />

    <p><strong>Enquiries</strong>
      <a title="Add a new enquiry"
         href="/bookings/captureenquiry">
          <img src="/images/add.png"/>
      </a>
    </p>
    <table class="listing" cellspacing="0">
        <thead>
          <td colspan="3">Reference</td>
          <td>Status</td>
        </thead>
        {% for enquiry in enquiries %}
        <tr>
          <td>{{ enquiry.referenceNumber }}</td>
          <td>{{ enquiry.state }}</td>
          <td class="action">
            <a title="Edit this enquiry"
              href="/bookings/editenquiry?enquirykey={{ enquiry.key }}">
              <img src="/images/edit.png"/>
            </a></td>
          <td class="action">
            <a title="Delete this enquiry"
              href="/bookings/deleteenquiry?enquirykey={{ enquiry.key }}"
                   onclick="return confirm('Are you sure?');">
              <img src="/images/delete.png"/>
            </a></td>
        </tr>
        {% endfor %}
    </table>

{% endblock pagecontent %}
